(window.webpackJsonp=window.webpackJsonp||[]).push([[350],{713:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zone"}},[t._v("#")]),t._v(" zone")]),t._v(" "),a("h2",{attrs:{id:"多-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多-zone"}},[t._v("#")]),t._v(" 多 zone")]),t._v(" "),a("p",[t._v("一个 zone 时一个单独的 Next.js 应用。如果你有很多 zone，你可以合并成一个应用。")]),t._v(" "),a("p",[t._v("例如，你如下有两个 zone：")]),t._v(" "),a("p",[t._v("1."),a("a",{attrs:{href:"https://docs.my-app.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.my-app.com"),a("OutboundLink")],1),t._v(" 服务于路由 /docs/**")]),t._v(" "),a("p",[t._v("2."),a("a",{attrs:{href:"https://ui.my-app.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ui.my-app.com"),a("OutboundLink")],1),t._v(" 服务于所有页面")]),t._v(" "),a("p",[t._v("有多 zone 应用技术支持，你可以将几个应用合并到一个，而且可以自定义 URL 路径，使你能同时单独开发各个应用。")]),t._v(" "),a("p",[t._v("与 microservices 观念类似, 只是应用于前端应用.")]),t._v(" "),a("h2",{attrs:{id:"怎么定义一个-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么定义一个-zone"}},[t._v("#")]),t._v(" 怎么定义一个 zone")]),t._v(" "),a("p",[t._v("one 没有单独的 API 文档。你需要做下面事即可：")]),t._v(" "),a("ul",[a("li",[t._v("确保你的应用里只有需要的页面 (例如, "),a("a",{attrs:{href:"https://ui.my-app.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ui.my-app.com"),a("OutboundLink")],1),t._v(" 不包含 /docs/**)")]),t._v(" "),a("li",[t._v("确保你的应用有个前缀 assetPrefix。（你也可以定义动态前缀 dynamically）")])]),t._v(" "),a("h2",{attrs:{id:"怎么合并他们"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么合并他们"}},[t._v("#")]),t._v(" 怎么合并他们")]),t._v(" "),a("p",[t._v("你能使用 HTTP 代理合并 zone")]),t._v(" "),a("p",[t._v("你能使用代理 micro proxy 来作为你的本地代理服务。它允许你定义路由规则如下")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rules"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pathname"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/docs**"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OPTIONS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dest"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://docs.my-app.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pathname"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/**"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dest"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://ui.my-app.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("生产环境部署，如果你使用了 ZEIT now，可以它的使用 path alias 功能。否则，你可以设置你已使用的代理服务编写上面规则来路由 HTML 页面")]),t._v(" "),a("h2",{attrs:{id:"技巧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技巧"}},[t._v("#")]),t._v(" 技巧")]),t._v(" "),a("ul",[a("li",[t._v("设置 301 重定向 :"),a("a",{attrs:{href:"https://www.raygesualdo.com/posts/2017/05/09/301-redirects-with-nextjs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.raygesualdo.com/posts/2017/05/09/301-redirects-with-nextjs/"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("只处理服务器端模块:"),a("a",{attrs:{href:"https://arunoda.me/blog/ssr-and-server-only-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://arunoda.me/blog/ssr-and-server-only-modules"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("构建项目 React-Material-UI-Next-Express-Mongoose-Mongodb:"),a("a",{attrs:{href:"https://github.com/builderbook/builderbook",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/builderbook/builderbook"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("构建一个 SaaS 产品 React-Material-UI-Next-MobX-Express-Mongoose-MongoDB-TypeScript:"),a("a",{attrs:{href:"https://github.com/async-labs/saas",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/async-labs/saas"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"问答"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问答"}},[t._v("#")]),t._v(" 问答")]),t._v(" "),a("p",[t._v("这个产品可以用于生产环境吗？"),a("code",[t._v("<https://zeit.co>")]),t._v(" 都是一直用 Next.js 写的。\n它的开发体验和终端用户体验都很好，所以我们决定开源出来给大家共享。")]),t._v(" "),a("p",[t._v("体积多大？\n客户端大小根据应用需求不一样大小也不一样。")]),t._v(" "),a("p",[t._v("一个最简单 Next 应该用 gzip 压缩后大约 65kb")]),t._v(" "),a("p",[t._v("这个像 "),a("code",[t._v("create-react-app")]),t._v("?\n是或不是.")]),t._v(" "),a("p",[t._v("是，因为它让你的 SSR 开发更简单。")]),t._v(" "),a("p",[t._v("不是，因为它规定了一定的目录结构，使我们能做以下更高级的事：")]),t._v(" "),a("p",[t._v("服务端渲染\n自动代码分割\n此外，Next.js 还提供两个内置特性：")]),t._v(" "),a("p",[t._v("路由与懒加载组件: "),a("code",[t._v("<Link>")]),t._v(" (通过引入 next/link)\n修改"),a("code",[t._v("<head>")]),t._v("的组件: "),a("code",[t._v("<Head>")]),t._v(" (通过引入 next/head)\n如果你想写共用组件，可以嵌入 Next.js 应用和 React 应用中，推荐使用 create-react-app。你可以更改 import 保持代码清晰。")]),t._v(" "),a("p",[t._v("怎么解决 CSS 嵌入 JS 问题?\nNext.js 自带 styled-jsx 库支持 CSS 嵌入 JS。而且你可以选择其他你喜欢的嵌入方法到你的项目中，可参考文档嵌入样式。")]),t._v(" "),a("p",[t._v("哪些语法会被转换？怎么转换它们？\n我们遵循 V8 引擎的，如今 V8 引擎广泛支持 ES6 语法以及 async 和 await 语法，所以我们支持转换它们。但是 V8 引擎不支持修饰器语法，所以我们也不支持转换这语法。")]),t._v(" "),a("p",[t._v("可以参照这些 以及 这些")]),t._v(" "),a("p",[t._v("为什么使用新路由?\nNext.js 的特别之处如下所示:")]),t._v(" "),a("p",[t._v("路由不需要被提前知道\n路由总是被懒加载\n顶层组件可以定义生命周期 getInitialProps 来阻止路由加载（当服务端渲染或路由懒加载时）\n因此,我们可以介绍一个非常简单的路由方法,它由下面两部分组成:")]),t._v(" "),a("p",[t._v("每个顶层组件都将会收到一个 url 对象，来检查 url 或修改历史记录")]),t._v(" "),a("p",[a("code",[t._v("<Link />")]),t._v("组件用于包装如("),a("code",[t._v("<a/>")]),t._v(")标签的元素容器，来执行客户端转换。\n我们使用了些有趣的场景来测试路由的灵活性，例如，可查看 nextgram。")]),t._v(" "),a("p",[t._v("我怎么定义自定义路由?\n我们通过请求处理来添加任意 URL 与任意组件之前的映射关系。")]),t._v(" "),a("p",[t._v("在客户端，我们"),a("code",[t._v("<Link>")]),t._v("组件有个属性 as，可以装饰改变获取到的 URL。")]),t._v(" "),a("p",[t._v("怎么获取数据?\n这由你决定。getInitialProps 是一个异步函数 async（也就是函数将会返回个 Promise）。你可以在任意位置获取数据。")]),t._v(" "),a("p",[t._v("我可以使用 GraphQL 吗?\n是的! 这里有个例子 Apollo.")]),t._v(" "),a("p",[t._v("我可以使用 Redux 吗?\n是的! 这里有个例子")]),t._v(" "),a("p",[t._v("我可以在 Next 应用中使用我喜欢的 Javascript 库或工具包吗?\n从我们第一次发版就已经提供很多例子，你可以查看这些例子。")]),t._v(" "),a("p",[t._v("什么启发我们做这个?\n我们实现的大部分目标都是通过 Guillermo Rauch 的 Web 应用的 7 原则来启发出的。")]),t._v(" "),a("p",[t._v("PHP 的易用性也是个很好的灵感来源，我们觉得 Next.js 可以替代很多需要用 PHP 输出 HTML 的场景。")]),t._v(" "),a("p",[t._v("与 PHP 不同的是，我们得利于 ES6 模块系统，每个文件会输出一个组件或方法，以便可以轻松的导入用于懒加载和测试")]),t._v(" "),a("p",[t._v("我们研究 React 的服务器渲染时并没有花费很大的步骤，因为我们发现一个类似于 Next.js 的产品，React 作者 Jordan Walke 写的 react-page (现在已经废弃)")])])}),[],!1,null,null,null);s.default=n.exports}}]);